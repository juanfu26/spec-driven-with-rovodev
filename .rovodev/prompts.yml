# RovoDev Agent Commands Configuration
# Complete development automation system with expert subagents

# === COMMANDS (Unified list for compatibility) ===
prompts:

  - name: Prompt Template (Example)
    description: "[P1] Plantilla base para crear nuevos prompts con objetivo, instrucciones y salida."
    content_file: commands/prompt_template.md

  # P1 - Exploration & Analysis
  - name: Analyze Improvement
    description: "[P1] Exploración y viabilidad de una mejora con sequential-thinking, revisión de wiki/ y consulta selectiva de subagentes."
    content_file: commands/p1_exploration/p1_analyze_improvement.md
  - name: Requirements Collection
    description: "[P1] Recopilar requisitos multidisciplinar para producir un SRS con objetivos, estimaciones y planificación de alto nivel."
    content_file: commands/p1_exploration/p1_requirements_collection.md
 
  - name: Meta prompt
    description: "[P1] Mejorar un prompt."
    content_file: commands/p1_exploration/p1_prepare_meta_prompt.md

  # P2 – Requirement Definition (BDD)
  - name: Complete Jira Ticket
    description: "[P2] Mejorar y completar un ticket de Jira."
    content_file: commands/p2_requirements_bdd/p2_complete_jira_ticket.md

  # P3 – Technical Design & Task Refinement
  - name: Plan Ticket
    description: "[P3] Intelligent Jira ticket analysis and planning."
    content_file: commands/p3_technical_design/p3_plan_ticket_on_wiki.md

  # P4 – Implementation Planning (OpenSpec)
  - name: Initialize Project
    description: "[P4] Complete project setup with OpenSpec documentation, code guardian generation, and Jira/Confluence integration."
    content_file: commands/p4_implementation_planning/p4_initialize_project.md
  - name: OpenSpec Draft
    description: "[P4] Crear spec mínima en la wiki."
    content_file: commands/p4_implementation_planning/p4_openspec_draft.md

  # P5 – Documentation Engineering (OpenSpec)
  - name: OpenSpec Validate
    description: "[P5] Marcar spec como validada."
    content_file: commands/p5_documentation/p5_openspec_validate.md
  - name: OpenSpec Finalize
    description: "[P5] Finalizar spec tras merge."
    content_file: commands/p5_documentation/p5_openspec_finalize.md
  - name: OpenSpec Bootstrap Wiki
    description: "[P5] Preparar wiki para OpenSpec."
    content_file: commands/p5_documentation/p5_openspec_bootstrap_wiki.md
  - name: Update Documentation
    description: "[P5] Synchronizes project documentation with code changes."
    content_file: commands/p5_documentation/p5_update_documentation.md

  # P6 – Execution & Delivery
  - name: Implement from Jira
    description: "[P6] Implementación desde tickets de Jira."
    content_file: commands/p6_execution/p6_implement_from_jira.md
  - name: Implement Ticket
    description: "[P6] Automatic implementation including code, tests, and docs."
    content_file: commands/p6_execution/p6_implement_ticket.md
  - name: Develop Backend
    description: "[P6] Flujo end-to-end para tickets backend."
    content_file: commands/p6_execution/p6_develop_backend.md
  - name: Develop Trying
    description: "[P6] Herramientas experimentales de desarrollo."
    content_file: commands/p6_execution/p6_develop_trying.md
  - name: Evolve Project
    description: "[P6] Applies best practices and patterns to evolve projects."
    content_file: commands/p6_execution/p6_evolve_project.md
  - name: Commit
    description: "[P6] Commits organizados (sin PR)."
    content_file: commands/p6_execution/p6_commit.md
  - name: Generate PR
    description: "[P6] Generar solo contenido de PR (git diff base)."
    content_file: commands/p6_execution/p6_generate_pr.md
  - name: Commit and PR
    description: "[P6] Commits organizados y generar PR (archivo)."
    content_file: commands/p6_execution/p6_commit_and_pr.md

  # P7 – Review, Optimization & Hardening
  - name: OpenSpec Audit Wiki
    description: "[P7] Auditar wiki OpenSpec."
    content_file: commands/p7_review_optimization/p7_openspec_audit_wiki.md
  - name: Generate Code Guardian
    description: "[P7] Creates project-specific code guardian rules."
    content_file: commands/p7_review_optimization/p7_generate_code_guardian.md

# === SUBAGENTS CONFIGURATION ===
subagents:

  - name: Subagent Template (Example)
    description: Plantilla para definir subagentes con herramientas y proceso.
    content_file: subagents/subagent_template.md
    consultation_points: [initialize]

  - name: Architecture Expert
    description: Specialized consultant for architectural decisions, design patterns, and technology stack recommendations based on project analysis and requirements.
    content_file: subagents/architecture-expert.md
    domain: architecture_design
    consultation_points: [initialize, plan, implement]
    
  - name: Code Guardian
    description: Project-specific quality guardian that enforces coding standards, validates implementations, and ensures pattern compliance. Generated dynamically per project.
    content_file: subagents/code-guardian.md
    domain: quality_assurance
    consultation_points: [implement, validate]
    generated: true
    
  - name: DevOps Automation
    description: Expert in CI/CD pipeline configuration, deployment strategies, containerization, and infrastructure automation.
    content_file: subagents/devops-automation.md
    domain: devops_infrastructure
    consultation_points: [initialize, implement, deploy]
    
  - name: Testing Expert
    description: Specialist in testing strategies, automatic test generation, coverage optimization, and quality metrics validation.
    content_file: subagents/testing-expert.md
    domain: testing_quality
    consultation_points: [plan, implement]
    
  - name: Performance Expert
    description: Expert in performance analysis, optimization strategies, bottleneck detection, and monitoring setup for optimal application performance.
    content_file: subagents/performance-expert.md
    domain: performance_optimization
    consultation_points: [plan, implement, monitor]
    
  - name: Security Expert
    description: Experto en seguridad y cumplimiento.
    content_file: subagents/security-expert.md
    domain: security_compliance
    consultation_points: [plan, implement, validate]
    
  - name: Commit Expert
    description: Organiza commits (conventional commits).
    content_file: subagents/commit-expert.md
    domain: version_control
    consultation_points: [finalization]
    
  - name: Pull Request Expert
    description: Redacta PRs completas y legibles.
    content_file: subagents/pullrequest-expert.md
    domain: code_review
    consultation_points: [finalization]
    
  - name: Openspec Expert
    description: Estructura y reglas de OpenSpec.
    content_file: subagents/openspec-expert.md
    domain: documentation
    consultation_points: [plan, implement]
    
  - name: Portainer Expert
    description: Operaciones y automatización en Portainer.
    content_file: subagents/portainer-expert.md
    domain: devops
    consultation_points: [implement, validate]


# === WORKFLOW CONFIGURATION ===
workflows:
  complete_development_cycle:
    description: "Full development cycle from Jira ticket to production deployment"
    steps:
      - initialize-project    # One-time setup
      - plan-ticket          # Per ticket planning
      - implement-ticket     # Implementation with all validations
      - commit-and-pr       # Professional finalization
    estimated_time: "2-3 hours for standard features"
    quality_gates: ["testing", "security", "performance", "documentation"]
    
  quick_implementation:
    description: "Rapid implementation for simple changes"
    steps:
      - plan-ticket
      - implement-ticket
      - commit-and-pr
    estimated_time: "30-60 minutes"
    
  project_setup:
    description: "Initial project configuration and documentation setup"
    steps:
      - initialize-project
      - generate-code-guardian
    estimated_time: "10-15 minutes"

# === QUALITY GATES CONFIGURATION ===
quality_standards:
  test_coverage:
    minimum: 85
    target: 95
    enforcement: automatic
    
  security_scan:
    vulnerability_tolerance: none_critical
    compliance_standards: [OWASP, GDPR]
    enforcement: blocking
    
  performance_benchmarks:
    response_time_p95: "< 200ms"
    startup_time: "< 30s"
    memory_usage: "project_specific"
    
  code_quality:
    complexity_threshold: 10
    duplication_tolerance: 5
    documentation_coverage: 90

# === INTEGRATION SETTINGS ===
integrations:
  jira:
    automatic_updates: true
    status_transitions: true
    comment_updates: true
    
  confluence:
    documentation_sync: true
    automatic_page_creation: true
    
  git:
    automatic_branching: true
    conventional_commits: true
    pr_templates: true

# === SYSTEM METADATA ===
system:
  version: "1.0.0"
  last_updated: "2025-12-22"
  total_commands: 18
  total_subagents: 10
  supported_languages: [python, javascript, typescript, java, go]
  supported_frameworks: [fastapi, react, angular, django, spring, nestjs]
  supported_platforms: [docker, kubernetes, aws, azure, gcp]

# === POLICIES & GUARDRAILS (Tool Preference & Security) ===
policies:
  tool_usage:
    must_use_mcp_tools: true
    preferred_tools:
      - filesystem
      - git
      - memory
      - docker
      - portainer
      - redis
      - influxdb
      - postgresql
      - keycloak
    forbidden_shell_commands:
      - "git*"
    guidance:
      - "Usa exclusivamente las tools MCP para acceder a archivos, Git y servicios externos."
      - "Evita ejecutar comandos git en shell; utiliza el MCP Git (status, show, log, blame, ls-files, branch)."
      - "No invoques servicios externos por shell (curl/wget) a menos que exista un MCP habilitado explícitamente."

  git_policy:
    prefer_mcp_git: true
    forbidden_shell_git: true
    allowed_mcp_git_commands: [status, show, log, blame, ls-files, branch]
    denied_operations: [push, fetch, pull, clone, checkout, reset, rebase, merge, commit]
    rationale: "Minimizar riesgo de mutaciones y exfiltración; centralizar auditoría vía MCP."

  filesystem_policy:
    scope_roots: ["/workspace/code", "/workspace/wiki"]
    readonly: true
    max_file_size_bytes: 1048576
    rationale: "Principio de mínimo privilegio y límites de datos."

  external_services_policy:
    activation: "disabled_by_default"
    readonly_default: true
    credential_injection: "env_only_no_repo"
    require_scoping: true
    examples:
      docker:
        allowed_images_env: MCP_DOCKER_ALLOWED_IMAGES
      portainer:
        endpoints_env: MCP_PORTAINER_ALLOWED_ENDPOINTS
      postgresql:
        allowed_schemas_env: MCP_POSTGRES_ALLOWED_SCHEMAS
      influxdb:
        bucket_org_scoped: true
      keycloak:
        client_scope_minimized: true
    rationale: "Evitar fugas de datos y limitar superficies de ataque."

  compliance:
    jira_modifications_require_consent: true
    confluence_publication_requires_confirmation: true
    notes:
      - "Nunca crear/editar/transicionar/comentar en Jira sin permiso explícito."
      - "Documentar análisis significativos en Confluence opcionalmente, previo consentimiento."
